<!DOCTYPE html>
<html lang="ko" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>WAVE Market - ì¤‘ê³  ê±°ë˜ í”Œë«í¼</title>
    <!-- êµ¬ê¸€ í°íŠ¸ (Poppins) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- ë¡œê³  -->
    <link rel="icon" href="/img/wave-logo.png"/>
    <!-- Bootstrap 5 CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Swiper CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ -->
    <link rel="stylesheet" href="/css/product/product-list.css">
</head>
<body>

<header class="navbar navbar-expand-lg navbar-dark fixed-top wave-navbar">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="/">
            <img src="/img/wave-logo.png" alt="WAVE" height="90">
            <span class="ms-2 fw-bold fs-2">WAVE</span>
        </a>
        <div class="collapse navbar-collapse justify-content-end">
            <div class="search-container position-relative me-4">
                <input id="search-input" class="form-control" type="search" placeholder="ê²€ìƒ‰ (ìƒí’ˆ, ì¹´í…Œê³ ë¦¬, íƒœê·¸)"
                       aria-label="Search">
                <button id="search-btn" class="btn btn-primary search-btn"><i class="bi bi-search"></i></button>
            </div>
            <ul class="navbar-nav mb-2 mb-lg-0">
                <!-- ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•œ ê²½ìš° 'ë‚´ ìƒì ' ë²„íŠ¼ í‘œì‹œ -->
                <li class="nav-item me-3" sec:authorize="isAuthenticated()">
                    <a class="btn btn-light" href="/shop/products">ë‚´ ìƒì </a>
                </li>
                <!-- ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ê²½ìš° 'ë¡œê·¸ì¸' ë²„íŠ¼ í‘œì‹œ -->
                <li class="nav-item me-3" sec:authorize="!isAuthenticated()">
                    <a class="btn btn-light" href="/member/login">ë¡œê·¸ì¸</a>
                </li>
                <li class="nav-item me-3" sec:authorize="!isAuthenticated()">
                    <a class="nav-link btn-need-login" href="/member/login">WAVEí†¡</a>
                </li>
                <li class="nav-item me-3" sec:authorize="isAuthenticated()">
                    <a class="btn btn-outline-light" href="/chatRoom">WAVEí†¡</a>
                </li>
                <li class="nav-item" sec:authorize="!isAuthenticated()">
                    <a class="nav-link btn-need-login" href="/member/login">íŒë§¤í•˜ê¸°</a>
                </li>
                <li class="nav-item" sec:authorize="isAuthenticated()">
                    <a class="btn btn-outline-light" href="/product/upload">íŒë§¤í•˜ê¸°</a>
                </li>
            </ul>
        </div>
    </div>
</header>

<!-- ë©”ì¸ ë°°ê²½: íŒŒë„ ëª¨ì…˜ íš¨ê³¼ì™€ ì—¬ìœ ë¡œìš´ ì†Œê°œ ì„¹ì…˜ -->
<section class="wave-hero">
    <div class="container text-center text-white">
        <h1 class="display-3 fw-bold">í¸ì•ˆí•œ íŒŒë„ ìœ„ì—ì„œ ê±°ë˜ë¥¼ ì¦ê¸°ì„¸ìš”</h1>
        <p class="lead fs-5">WAVE Marketì€ ì¤‘ê³  ê±°ë˜ë¥¼ ë” ì—¬ìœ ë¡­ê³  ê°ì„±ì ìœ¼ë¡œ ë§Œë“¤ì–´ ë“œë¦½ë‹ˆë‹¤.</p>
    </div>
</section>

<!-- ë°°ë„ˆ ì˜ì—­ (Swiper ìŠ¬ë¼ì´ë”) -->
<div class="container my-5">
    <div class="swiper-container banner-slider">
        <div class="swiper-wrapper">
            <!-- ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ: ë™ì˜ìƒ -->
            <div class="swiper-slide">
                <video class="w-100 h-100" autoplay muted loop playsinline>
                    <source src="/video/1472467_People_Leisure.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <!-- ë‘ ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ: ë™ì˜ìƒ -->
            <div class="swiper-slide">
                <video class="w-100 h-100" autoplay muted loop playsinline>
                    <source src="/video/0_Beach_Vacation.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <!-- ì„¸ ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ: ë™ì˜ìƒ -->
            <div class="swiper-slide">
                <video class="w-100 h-100" autoplay muted loop playsinline>
                    <source src="/video/7445_Surfer_Surfing.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>
        <!-- Swiper ì»¨í…Œì´ë„ˆì˜ ìì‹ ìš”ì†Œë¡œ í˜ì´ì§€ë„¤ì´ì…˜ê³¼ ë‚´ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ë°°ì¹˜ -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>
    <div class="swiper-pagination"></div>
</div>

<!-- ì¶”ì²œ ìƒí’ˆ ì˜ì—­ -->
<main class="container my-5">
    <!-- ì¶”ì²œ ìƒí’ˆ ì œëª©ê³¼ í•„í„° í† ê¸€ ë²„íŠ¼ì„ ê°ì‹¸ëŠ” ë˜í¼ -->
    <div class="recommendation-header">
        <!-- í•„í„° ë˜í¼: ë²„íŠ¼ê³¼ ì‚¬ì´ë“œë°”ë¥¼ í•¨ê»˜ ê°ìŒˆ -->
        <div class="filter-wrapper me-3" style="position: relative; display: inline-block;">
            <button id="filter-toggle-btn" class="btn btn-outline-primary">
                <i class="bi bi-funnel-fill"></i> í•„í„°
            </button>
            <!-- í•„í„° ì‚¬ì´ë“œë°” (ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€) -->
            <div class="filter-sidebar">
                <div class="major-categories">
                    <!-- ì „ì²´ ë²„íŠ¼ -->
                    <button class="btn btn-outline-primary subcategory-btn all-btn" data-filter="all">ì „ì²´</button>
                    <!-- ë‚¨ì„±ì˜ë¥˜ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">ë‚¨ì„±ì˜ë¥˜</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="í‹°ì…”ì¸ ">í‹°ì…”ì¸ </button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì…”ì¸ ">ì…”ì¸ </button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë‚¨ì„±ë°”ì§€">ë°”ì§€</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì •ì¥">ì •ì¥</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë‚¨ì„±ì•„ìš°í„°">ì•„ìš°í„°</button>
                        </div>
                    </div>
                    <!-- ì—¬ì„±ì˜ë¥˜ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">ì—¬ì„±ì˜ë¥˜</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì›í”¼ìŠ¤">ì›í”¼ìŠ¤</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë¸”ë¼ìš°ìŠ¤">ë¸”ë¼ìš°ìŠ¤</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ìŠ¤ì»¤íŠ¸">ìŠ¤ì»¤íŠ¸</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì—¬ì„±ë°”ì§€">ë°”ì§€</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì—¬ì„±ì•„ìš°í„°">ì•„ìš°í„°</button>
                        </div>
                    </div>
                    <!-- ì‹ ë°œ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">ì‹ ë°œ</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ìš´ë™í™”">ìš´ë™í™”</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="êµ¬ë‘">êµ¬ë‘</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ìƒŒë“¤">ìƒŒë“¤</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë¶€ì¸ ">ë¶€ì¸ </button>
                        </div>
                    </div>
                    <!-- ê°€ë°©/ì§€ê°‘ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">ê°€ë°©/ì§€ê°‘</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë°±íŒ©">ë°±íŒ©</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="í† íŠ¸ë°±">í† íŠ¸ë°±</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ìˆ„ë”ë°±">ìˆ„ë”ë°±</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì§€ê°‘">ì§€ê°‘</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="í´ëŸ¬ì¹˜">í´ëŸ¬ì¹˜</button>
                        </div>
                    </div>
                    <!-- ì‹œê³„ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">ì‹œê³„</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë””ì§€í„¸">ë””ì§€í„¸</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì•„ë‚ ë¡œê·¸">ì•„ë‚ ë¡œê·¸</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ìŠ¤ë§ˆíŠ¸ì›Œì¹˜">ìŠ¤ë§ˆíŠ¸ì›Œì¹˜</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ê³¨ë“œ">ê³¨ë“œ</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì‹¤ë²„">ì‹¤ë²„</button>
                        </div>
                    </div>
                    <!-- ì¥¬ì–¼ë¦¬ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">ì¥¬ì–¼ë¦¬</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ëª©ê±¸ì´">ëª©ê±¸ì´</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë°˜ì§€">ë°˜ì§€</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ê·€ê±¸ì´">ê·€ê±¸ì´</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="íŒ”ì°Œ">íŒ”ì°Œ</button>
                        </div>
                    </div>
                    <!-- íŒ¨ì…˜ ì•¡ì„¸ì„œë¦¬ -->
                    <div class="major-category">
                        <button class="btn btn-outline-primary major-btn">íŒ¨ì…˜ ì•¡ì„¸ì„œë¦¬</button>
                        <div class="sub-category-menu">
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ëª¨ì">ëª¨ì</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ë²¨íŠ¸">ë²¨íŠ¸</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ì„ ê¸€ë¼ìŠ¤">ì„ ê¸€ë¼ìŠ¤</button>
                            <button class="btn btn-outline-secondary subcategory-btn" data-filter="ìŠ¤ì¹´í”„">ìŠ¤ì¹´í”„</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <h2 class="mb-0">ì¶”ì²œ ìƒí’ˆ</h2>
    </div>

    <!-- ìƒí’ˆì´ ì—†ì„ ì‹œ -->
    <div id="no-products-message" class="text-center" style="display: none;">
        <img src="/img/empty.png" alt="ìƒí’ˆ ì—†ìŒ">
        <p class="mt-3 no-result-text">ì•—! ì—¬ê¸° ì•„ë¬´ê²ƒë„ ì—†ì–´ìš”... ì–¼ë¥¸ ìƒí’ˆì„ ì±„ì›Œì£¼ì„¸ìš”! ğŸ“¦</p>
        <a href="/" class="btn btn-primary mt-2">ì´ì „</a>
    </div>

    <!-- ìƒí’ˆ ì¹´ë“œ ì˜ì—­ -->
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4 product-container">
        <!-- ê° ìƒí’ˆ ì¹´ë“œ -->
        <div class="col product-item" th:each="product : ${productList}" th:data-category="${product.category}?:'none'">
            <div class="card h-100 shadow-sm product-card">

                <a th:href="@{/product/detail/{id}(id=${product.productId})}">
                    <img th:src="${product.thumbnailUrl}" class="card-img-top" alt="ìƒí’ˆ ì´ë¯¸ì§€">
                </a>
                <div class="card-body">
                    <h5 class="card-title text-truncate" th:text="${product.productName}"></h5>
                    <p class="card-text text-muted small text-truncate" th:text="${product.tag}"></p>
                    <div class="d-flex justify-content-between align-items-center">
                        <p class="fw-bold mb-0" id="price"
                           th:if="${product.price >= 1000}"
                           th:text="${#numbers.formatInteger(product.price, 3, 'COMMA')} + 'ì›'"></p>
                        <p class="fw-bold mb-0" id="price"
                           th:if="${product.price < 1000}"
                           th:text="${product.price} + 'ì›'"></p>
                        <p class="text-muted small mb-0">
                            <span th:text="${product.getTimeAgo()}"></span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Footer -->
<footer class="wave-footer text-center py-4">
    <p class="mb-0 text-muted">&copy; 2025 WAVE Market. All rights reserved.</p>
</footer>

<!-- ê²€ìƒ‰ or í•„í„° ì¡°íšŒ ì‹œ ìƒí’ˆì´ ì—†ì„ ë•Œ ì´ë¯¸ì§€ í‘œì‹œí•˜ê¸° -->
<script>
    const noProductsMessage = document.querySelector("#no-products-message");

    const updateNoProductsMessage = () => {
        const products = document.querySelectorAll(".product-item");
        if ([...products].every(p => p.style.display === "none")) {
            noProductsMessage.style.display = "block"; // ìƒí’ˆ ì—†ì„ ë•Œ í‘œì‹œ
        } else {
            noProductsMessage.style.display = "none"; // ìƒí’ˆ ìˆìœ¼ë©´ ìˆ¨ê¹€
        }
    };
    updateNoProductsMessage();

    // í•„í„° ë²„íŠ¼ í´ë¦­ ì‹œ, ë¨¼ì € ë©”ì‹œì§€ ìˆ¨ê¸°ê³  1ì´ˆ í›„ ë‹¤ì‹œ ì²´í¬
    document.querySelectorAll(".subcategory-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            noProductsMessage.style.display = "none"; // í´ë¦­ ì¦‰ì‹œ ìˆ¨ê¹€
            setTimeout(updateNoProductsMessage, 100); // 1ì´ˆ í›„ ë‹¤ì‹œ ì²´í¬
        });
    });
</script>
<!-- ë¹„íšŒì› ë¡œê·¸ì¸ ë¬¼ì–´ë³´ê¸° -->
<script>
    document.querySelectorAll(".btn-need-login").forEach(b => {
        b.addEventListener("click", e => {
            if (!confirm("ë¡œê·¸ì¸ í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                e.preventDefault();
            }
        });
    });
</script>
<!-- ìŠ¤ì™€ì´í¼, í•„í„° ì‚¬ì´ë“œë°” ì´ˆê¸°í™” -->
<script>
    document.addEventListener("DOMContentLoaded", () => {

        // 2. Swiper ë°°ë„ˆ ì´ˆê¸°í™”
        const initSwiper = () => {
            new Swiper(".banner-slider", {
                loop: true,
                autoplay: {delay: 3000},
                pagination: {el: ".swiper-pagination", clickable: true},
                navigation: {nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev"},
            });
        };

        // 3. í•„í„° ì‚¬ì´ë“œë°” ì´ˆê¸°í™”
        const initFilterSidebar = () => {
            const filterToggleBtn = document.querySelector("#filter-toggle-btn");
            const filterSidebar = document.querySelector(".filter-sidebar");

            // í•„í„° í† ê¸€ ë²„íŠ¼ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” í‘œì‹œ/ìˆ¨ê¹€
            filterToggleBtn.addEventListener('click', () => {
                filterSidebar.style.display = (filterSidebar.style.display === 'block') ? 'none' : 'block';
            });

            // ì‚¬ì´ë“œë°” ë‚´ ì†Œë¶„ë¥˜ ë²„íŠ¼ í´ë¦­ ì‹œ ìƒí’ˆ í•„í„°ë§
            document.querySelectorAll('.filter-sidebar .subcategory-btn').forEach((btn) => {
                btn.addEventListener('click', () => {
                    const filterValue = btn.getAttribute('data-filter').toLowerCase();
                    document.querySelectorAll('.product-item').forEach((item) => {
                        if (filterValue === 'all') {
                            item.style.display = '';
                        } else {
                            const itemCategory = item.getAttribute('data-category').toLowerCase();
                            item.style.display = (itemCategory === filterValue) ? '' : 'none';
                        }
                    });
                    // í•„í„° ì ìš© í›„ ì‚¬ì´ë“œë°” ìˆ¨ê¹€ (ì˜µì…˜)
                    filterSidebar.style.display = 'none';
                });
            });
        };

        // ì´ˆê¸°í™” í•¨ìˆ˜ í˜¸ì¶œ
        initSwiper();
        initFilterSidebar();
    });
</script>
<script src="/js/util/search.js"></script>
</body>
</html>
